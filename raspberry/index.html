<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Covid19-CC</title>
</head>

<body>
<h2>Registo de entradas e saídas</h2>
<div>
    <!--<label>Selecionar ou Inserir Zona:</label>

    onchange="getSelectedText(this)"

    -->
    <p>Selecionar ou Inserir Zona:</p>
    <form action="" method="get">
        <input type="text" id="zone" list="zone-select"/>
        <datalist id="zone-select">
            <option value = "IPLeiria">
            <option value = "Leiria-Shopping">
        </datalist>
        <button type="button" id="addzone" onclick="createzone()">Adicionar zona</button>
        <button type="button" id="deletezone" onclick="delzone()">Apagar zona</button>
    </form>
    <!--<label for="zone">Nome da Zona: </label>
    <input type="text" id="zone" name="zone" value="Leiria-Shopping"><br><br> -->
</div>
<div>
    <!--<label for="chave">Chave: </label> -->
    <p>Chave:</p>
    <input type="text" id="chave" name="chave" value="current">
</div>

<div>
    <p>Valor:</p>
    <!--<label for="value">Valor: </label> -->
    <input type="text" id="value" name="value">
    <button type="button" id="read" onclick="readzone()">Ler valores</button>
    <button type="button" id="update" onclick="updatezone()">Atualizar Valores</button><br><br>
</div>

<div>
    <button type="button" id="stateon" onclick="input()" style="background-color:green;">Registar Entrada</button>
    <button type="button" id="stateoff" onclick="output()" style="background-color:red;">Registar Saída</button>
    <button type="button" id="desinfection" onclick="desinfect()" style="background-color:lightblue;">Registar Desinfeção</button>
</div>

<br>

<script src="/socket.io/socket.io.js"></script>
<script>
    var socket = io(); //load socket.io-client and connect to the host

    /*
    var zone_ = "IPLeiria"; //default zone
    function getSelectedText(sel) {
        var zone_ = sel.options[sel.selectedIndex].text;
    }
     */

    function input() {
        let zone_ = document.getElementById("zone").value;
        socket.emit("inout", 1, zone_); //send button state to server
        socket.emit("newsensoreg", zone_, "Entrada", 1);
        console.log(zone_ + " Entrada");
    }

    function output() {
        let zone_ = document.getElementById("zone").value;
        socket.emit("inout", -1, zone_); //send button state to server
        socket.emit("newsensoreg", zone_, "Saida", 1);
        console.log(zone_ + " Saída");
    }

    function desinfect() {
        let zone_ = document.getElementById("zone").value;
        socket.emit("newsensoreg", zone_, "Desinfetante", 1);
        console.log(zone_ + " Desinfeção");
    }

    function readzone() {
        let zone_ = document.getElementById("zone").value;
        socket.emit("read", zone_);
    }

    function createzone() {
        let zone_ = document.getElementById("zone").value;
        socket.emit("create", zone_);
    }

    function delzone() {
        let zone_ = document.getElementById("zone").value;
        socket.emit("deletezone", zone_);
    }

    function updatezone() {
        let zone_ = document.getElementById("zone").value;
        let chave_ = document.getElementById("chave").value;
        let value_ = document.getElementById("value").value;
        socket.emit("update", zone_, chave_, Number(value_));
    }

</script>
</body>

</html>